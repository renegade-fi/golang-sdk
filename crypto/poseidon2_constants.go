package crypto

import (
	"github.com/consensys/gnark-crypto/ecc/bn254/fr"
)

// Poseidon2Sponge is a sponge
const (
	// R_F is the number of full rounds in the Poseidon permutation
	R_F = 8

	// R_P is the number of partial rounds in the Poseidon permutation
	R_P = 56

	// WIDTH is the width of the Poseidon permutation's code
	WIDTH = 3

	// RATE is the rate of the sponge construction layered on the permutation
	RATE = 2

	// CAPACITY is the capacity of the sponge construction layered on the permutation
	CAPACITY = 1

	// ALPHA is the constant used to parameterize the S-box in the Poseidon permutation
	ALPHA = 5
)

// FULL_ROUND_CONSTANTS are the round constants used in the full rounds of the Poseidon permutation
// In Montgomery form
var FULL_ROUND_CONSTANTS = [R_F][WIDTH]fr.Element{
	{
		{15502152792957798476, 2953781152519934815, 789263285804927433, 3266336410389770144},
		{6170676942082823556, 15509510193735291493, 7415284283107350036, 292284789622600672},
		{757465388580735786, 9338113740004941460, 4336519229747774095, 1724015472732820264},
	},
	{
		{11897734354526105482, 382803936206622191, 15583594833573223575, 26101612873401814},
		{300856827851981229, 14032028775303382291, 2617188922783846915, 3113460744175511160},
		{4984931335600051712, 9976247887725982828, 7804929919047832678, 325671243959858020},
	},
	{
		{780590299589500791, 7026256069362248290, 11426405700249100127, 1458096164295736319},
		{13296162094921968601, 44753975805549700, 15629490560871254778, 3376052348619018327},
		{2698317404801328286, 17122533406633804759, 4243449486661757924, 112816171727108236},
	},
	{
		{16694221045468315622, 13206706360994773267, 2637453804976253318, 1371323197885666843},
		{10814711845707134675, 2617256126236998707, 5078617910387707893, 3171166663453790249},
		{10581282052236454112, 920327580342871879, 1809921152754094646, 2952451477352947531},
	},
	{
		{10272062985991402324, 1789385957427024329, 6829188981757528840, 1334452382046530515},
		{2287389488892556512, 9557810034226530325, 11238136203329061678, 640093634633446383},
		{10674656607541490458, 12034463371938163603, 1523946443169213508, 3435847311396115168},
	},
	{
		{5431330165778569906, 13736557477407314915, 1007891038100558020, 1494297076098461693},
		{16486187715413599283, 1288120167315164385, 13531814379488375134, 1067296565687394241},
		{16120798776898361665, 10808712651871783905, 7877942940153928635, 153598939258726042},
	},
	{
		{4114265906301957769, 17064369371799549659, 5628188145576501830, 3280304867273800281},
		{1136923167063149958, 3049870787702696529, 8853727408716239410, 722919407429462358},
		{1004823759959960440, 5332784792303409876, 16945861725409851453, 3357860692328329233},
	},
	{
		{2773310989587397716, 7033164531599867338, 10838189875743268258, 1583403225790005621},
		{1722761551815968202, 7380918039859970794, 14124186686383768215, 3054968788075471068},
		{1912413466118342909, 7548062830909368746, 14267148137775213741, 401717070765615402},
	},
}

// PARTIAL_ROUND_CONSTANTS are the round constants used in the partial rounds
// of the Poseidon permutation in Montgomery form
var PARTIAL_ROUND_CONSTANTS = [R_P]fr.Element{
	{7073706554792388047, 15115725580624899978, 3679228461395092567, 1155120523926954320},
	{9209151483111776538, 17577545623568481397, 13585757825660930829, 3472890281115441576},
	{5142214011637547477, 6729742127441928110, 7928974164783286805, 2757086277530341826},
	{8938241568952998645, 15517955216953659229, 11832176850910503511, 1709055277527656310},
	{10956229512667018994, 11918198942059270728, 7489270581679030924, 3181831933222320922},
	{13682243995819403958, 16244539325158105347, 13578134094016967345, 2967916653048767308},
	{4532796573256683161, 14203231266637649398, 14753676872031977112, 2171546959744315338},
	{2106231522687407713, 18113360752044649324, 13935713332161711566, 2978133151621500848},
	{2536242657222803571, 2327885367823884921, 12202150727762980731, 3412910338632013146},
	{5348827700449979657, 887346057637975956, 8971042733055292716, 2100215248507926084},
	{11229488051831878184, 16099654520201454066, 14561282740763953106, 2667750380236746040},
	{12817536329194444742, 4345699324407709426, 900951713870023728, 1014832873001291213},
	{17293381378844367186, 16958792931800980627, 10826955139254045662, 1351854533747025865},
	{13291469682261563332, 1649148914274838951, 14341187994750770698, 1680998195896249649},
	{2055181655118809519, 10810347187661194231, 5130195530091742815, 2099274246510687817},
	{5757872273252181918, 2504696256780764765, 6168840323049663065, 951206805240552942},
	{18205601902513040080, 8616769320483560004, 9626925928588513499, 1488927967466599656},
	{2866389384139397319, 9451035544059617030, 4640747268029382870, 1524311337808189881},
	{12647826241612735435, 11361530487936731715, 7385098048539233709, 2293235911070107791},
	{8560626365907265470, 1702244564892847175, 11726462460637367353, 55231714683627599},
	{12528705743446697080, 17826656723235137851, 11726505195792820554, 104192341998302229},
	{5972114068786636064, 5593959081643725345, 5202526434716090911, 312152830751167664},
	{11767603016886161495, 3315880659968081158, 10429001002452042400, 1120539083923591765},
	{2608435967293178308, 15095365136975140233, 16196372276001929614, 17214869152833459},
	{2717742206866965755, 16948519095478104877, 70652684229740887, 3397703971638958705},
	{18438880355653239612, 10383672395409611462, 12562500475852982339, 1351332280730845810},
	{7136261624606834733, 12968497364184943925, 6498091135700138778, 2953967265667717033},
	{12737394657763702192, 18100635939834586322, 14938215425101085913, 1623799557259731894},
	{10004098586255924707, 9016154456109463533, 8884026714073685685, 1394677181198354927},
	{10979199599392596504, 9984357950610434812, 5643914051548913115, 961238282144348343},
	{13621227340297520947, 14145813743878790668, 5609457652645066217, 92499531020515958},
	{14022212315033497828, 12678167161610756266, 17875638127401783507, 1447065356198101528},
	{3036093808340812920, 16340294711038231176, 3695828784309612173, 544090326326849088},
	{1589142542057804178, 13822783131886290000, 14436815086407862994, 1019203912055255310},
	{10512968371844493245, 10543964245415077926, 9121033363513773816, 3439478095028192234},
	{12435234250434650169, 11847010231418324653, 5763890848613850394, 161189041961216243},
	{4598744753357237248, 5671922682403983961, 8803106759936573577, 881557652141128492},
	{12651615159157592285, 6726285222082676715, 8271064187588859377, 1747958794394704994},
	{7636599866956647349, 6611550994081642553, 2814215616725421596, 2999698905074267158},
	{9904179078508829768, 6673304376626190751, 8526932623086945198, 796920200050098977},
	{11556494072467605299, 4468673601808906001, 1334170865948842574, 2112758306903611195},
	{15269041975333172388, 3675199162426854798, 705759660068617242, 1203701982786267337},
	{15638123690285712973, 4810575992297666845, 15786618876003102494, 2462806264783001022},
	{8743213005744473450, 13620832195973691263, 15461528997160942263, 446814529846810855},
	{12778175438404731722, 10619140899819573097, 15160222215525361737, 2313191208040437031},
	{9192466807208266837, 4171055167000668107, 5440143564937205610, 675261765582374279},
	{17648316560660710600, 7049003404542118025, 3858207628346508423, 295626623247458522},
	{8544832972630087377, 3646708173474949416, 13302432669248895106, 2126825808184316693},
	{16694739697448549680, 9087453730816628582, 15742480699685729986, 1594348579824091149},
	{2595805662428353436, 8510048486975124974, 10230358823539845936, 3002386375523412115},
	{7017591622231268913, 4979976608575864605, 3720328620161091644, 1351550462155876175},
	{14701723975178220509, 5477768274109186884, 16710908674777711907, 976911670744366643},
	{16033202434354431769, 8702165811894747337, 6964646275766541591, 2026674245872392530},
	{2856212656777916968, 15861536721839817111, 7670550620118212707, 1139910101109232850},
	{1883458262561125446, 620533140182598482, 8910500411162538238, 584159302112304714},
	{17694422254561656643, 18371504624464762237, 7832616857063567079, 2695504646374494466},
}
